//https://codeforces.com/contest/2161/submission/350918577

#include <bits/stdc++.h>
#define ll long long int
#define db double

const int N=1e4+10;
const ll M = 1000000007;
using namespace std;

vector<bool>prime(N , true) ;

vector<ll>p;

void fiill(){

    p.push_back(1LL);

    while(p.size()<=N){
        p.push_back(p.back()+4LL);
    }

}


void seive(){

    prime[1] = false ;
    prime[0] = false;


    for (int i = 2; i*i <= N; i++) {
        if (prime[i]) {


            for (int j = i * i; j <= N; j += i)
                prime[j] = false;
        }
    }




}

void pr_f(vector<ll>p , vector<ll>&p_f ,ll n , int i){

    if(prime[n])
    {
        p_f.push_back(n) ;
        return;
    }

    if(n%p[i] == 0){
        p_f.push_back(p[i]);
        pr_f(p,p_f, n/p[i], i);

    } else
    {
        pr_f(p,p_f, n, i+1);
    }

}

void check(vector<ll>&v , ll m){

    set<ll>s ;
    ll sum = 0;
    ll ans = 0;
    int i =0;
    s.insert(0);

    while(i<v.size()){

        sum+=v[i] ;


        if(s.count(sum/m)==0){

           // cout<<v[i] <<" " ;
            ans +=v[i] ;
            s.insert(sum/m);
        }

        i++;

    }

    cout<<ans<<endl;
}


void solve(){

    ll n , m;
    cin>>n>>m ;

    vector<ll>v(n) , f;

    for(int i=0; i<n; i++)
        cin>>v[i] ;

      //  check(v, m);

    sort(v.begin() , v.end());

    set<ll>st ;

    st.insert(0);

    ll ans = 0 , l =0 , r =n-1 , sum =0 ;

     //cout<<endl<<endl ;

   // for(auto u : v)cout<<u<<" ";cout<<endl;

    while(l<=r){

        ll x = sum+v[l];
        ll y = sum+v[r];

        ll c = x/ m;
        ll d = y/ m;

        //cout<<c<<" "<<d<<endl;


          if(st.count(d)==0){

            st.insert(d) ;
            sum+= v[r] ;
            //cout<<v[r]<<endl;
            ans += v[r] ;
            f.push_back(v[r]);
            r--;
        } else if(st.count(c)==0){

            st.insert(c);
            sum+= v[l] ;

            cout<<v[l]<<endl;

            ans+=v[l] ;
            f.push_back(v[l]);
            l++;
        }



        else {

            sum+=v[l] ;
            f.push_back(v[l]);
            l++;

        }


    }



    cout<<endl<<ans<<endl;

    for(auto u :f)cout<<u<<" ";

    cout<<endl;

}
//13:13



int main()
{
    ios::sync_with_stdio(false);
    cin.tie(0);

    //seive();
    //fiill();



    int t = 1;
    cin >> t;
    int i = 1;
    while (t--)
    {
        //cout<<"Case "<<i<<": ";

        solve();
        i++;

    }
    return 0;
    }
